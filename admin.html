<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Login - Dharini Flower Jewellery</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body class="bg-pink-50 font-poppins">

  <div id="loginDiv" class="container mx-auto p-6 max-w-md mt-20 bg-white rounded-xl shadow-md">
    <h3 class="text-2xl font-bold text-pink-800 mb-4 text-center">Admin Login</h3>
    <input id="adminID" type="text" placeholder="Enter Admin ID" class="w-full border rounded-lg px-3 py-2 mb-3">
    <input id="adminPass" type="password" placeholder="Enter Password" class="w-full border rounded-lg px-3 py-2 mb-3">
    <button onclick="checkLogin()" class="bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 w-full">Login</button>
  </div>

  <div id="panelDiv" class="container mx-auto p-6 hidden">
    <h3 class="text-2xl font-bold text-pink-800 mb-4">Admin Panel</h3>

    <input id="productName" type="text" placeholder="Product Name" class="w-full border rounded-lg px-3 py-2 mb-3">
    <textarea id="productDesc" placeholder="Product Description" class="w-full border rounded-lg px-3 py-2 mb-3"></textarea>
    <input id="productPrice" type="text" placeholder="Price" class="w-full border rounded-lg px-3 py-2 mb-3">
    <input id="productImage" type="file" accept="image/*" class="w-full border rounded-lg px-3 py-2 mb-3">
    <button onclick="addProduct()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">Add Product</button>
  </div>

  <script>
    // FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "AIzaSyARKrfUDH1sJr5rIrx5VSpTA0mdigSUDew",
      authDomain: "dharini-flower-jewellery.firebaseapp.com",
      projectId: "dharini-flower-jewellery",
      storageBucket: "dharini-flower-jewellery.appspot.com",
      messagingSenderId: "953232943869",
      appId: "1:953232943869:web:04b04ccbcbe3b0e759ac94"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // CLOUDINARY CONFIG
    const CLOUD_NAME = "dyqf1xo36";
    const UPLOAD_PRESET = "dharini-flower-jewellery";

    // Admin credentials (change as you like)
    const ADMIN_ID = "dhariniAdmin";
    const ADMIN_PASS = "flower123";

    function checkLogin() {
      const id = document.getElementById("adminID").value;
      const pass = document.getElementById("adminPass").value;
      if (id === ADMIN_ID && pass === ADMIN_PASS) {
        // hide login, show panel
        document.getElementById("loginDiv").classList.add("hidden");
        document.getElementById("panelDiv").classList.remove("hidden");
      } else {
        alert("Incorrect ID or Password!");
      }
    }

    async function addProduct() {
      const name = document.getElementById("productName").value;
      const desc = document.getElementById("productDesc").value;
      const price = document.getElementById("productPrice").value;
      const file = document.getElementById("productImage").files[0];

      if (!file) return alert("Please select an image.");

      const formData = new FormData();
      formData.append("file", file);
      formData.append("upload_preset", UPLOAD_PRESET);

      const res = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
        method: "POST",
        body: formData
      });

      const data = await res.json();

      db.collection("products").add({
        name, desc, price, img: data.secure_url
      }).then(() => {
        alert("Product added successfully!");
        document.getElementById("productName").value = "";
        document.getElementById("productDesc").value = "";
        document.getElementById("productPrice").value = "";
        document.getElementById("productImage").value = "";
      }).catch(err => {
        console.error(err);
        alert("Error adding product.");
      });
    }
  </script>
</body>
</html>
